<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Darcy world"><title>Elasticsearch监控 | Darcy Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Elasticsearch监控</h1><a id="logo" href="/.">Darcy Blog</a><p class="description">The more I see of the world, the more I am dissatisfied with it</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Elasticsearch监控</h1><div class="post-meta">May 11, 2017<span> | </span><span class="category"><a href="/categories/Elasticsearch/">Elasticsearch</a></span></div><div class="post-content"><h1 id="Elasticsearch监控"><a href="#Elasticsearch监控" class="headerlink" title="Elasticsearch监控"></a>Elasticsearch监控</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>ElasticSearch是目前很流行的搜索服务器，ElasticSearch基于RESTful web接口提供服务。其监控从大的层面主要分为cluster监控和node监控两类。其中cluster监控又分为health和state两类，node的监控分为fs,http,indices,jvm,thread_pool 5个小类，按照需求总共采集了103项数据，全部基于ElasticSearch的接口采集，各采集项的释义见第三章《监控项释义》</p>
<h2 id="监控部署"><a href="#监控部署" class="headerlink" title="监控部署"></a>监控部署</h2><p>使用zabbix监控的监控采集脚本和监控模板已经分享到github，链接如下 <a href="https://github.com/chaubeau/Elasticsearch-zabbix-monitor。为了使监控脚本更具有通用性，所以脚本全部使用bash" target="_blank" rel="noopener">https://github.com/chaubeau/Elasticsearch-zabbix-monitor。为了使监控脚本更具有通用性，所以脚本全部使用bash</a> shell编写，如果Elasticsearch未使用默认的http端口启动，则需修改es_mon.sh的PORT变量。</p>
<h2 id="监控项释义"><a href="#监控项释义" class="headerlink" title="监控项释义"></a>监控项释义</h2><table>
<thead>
<tr>
<th>监控项</th>
<th>单位</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>es_cluster.health.status</td>
<td></td>
<td>该集群健康数字：红=0，黄色=1，绿=2</td>
</tr>
<tr>
<td>es_cluster.health.active_primary_shards</td>
<td>shard</td>
<td>集群中活跃的主分片数量</td>
</tr>
<tr>
<td>es_cluster.health.shards</td>
<td>shard</td>
<td>集群中活跃分片数量</td>
</tr>
<tr>
<td>es_cluster.health.initializing_shards</td>
<td>shard</td>
<td>正在初始化的shard</td>
</tr>
<tr>
<td>es_cluster.health.number_of_pending_tasks</td>
<td>task</td>
<td>待执行的task</td>
</tr>
<tr>
<td>es_cluster.health.relocating_shards</td>
<td>shard</td>
<td>从一个节点搬到另一个节点的分片数量</td>
</tr>
<tr>
<td>es_cluster.health.unassigned_shards</td>
<td>shard</td>
<td>未分配给节点的分片数量</td>
</tr>
<tr>
<td>es_cluster.state.docs_count</td>
<td>doc</td>
<td>集群中所有分片的document数量</td>
</tr>
<tr>
<td>es_cluster.state.docs_deleted</td>
<td>doc</td>
<td>集群中所有分片删除的document数量</td>
</tr>
<tr>
<td>es_cluster.state.number_of_data_nodes</td>
<td>node</td>
<td>集群中数据节点总数</td>
</tr>
<tr>
<td>es_cluster.state.number_of_nodes</td>
<td>node</td>
<td>集群中的节点总数</td>
</tr>
<tr>
<td>es_node.fs.total_available_in_bytes</td>
<td>bytes</td>
<td>虚拟机可用的字节总数</td>
</tr>
<tr>
<td>es_node.fs.total_disk_io_op</td>
<td>operations</td>
<td>操作的总次数</td>
</tr>
<tr>
<td>es_node.fs.total_disk_io_size_in_bytes</td>
<td>bytes</td>
<td>操作使用的总字节数</td>
</tr>
<tr>
<td>es_node.fs.total_disk_read_size_in_bytes</td>
<td>bytes</td>
<td>从文件存储读取的总字节数</td>
</tr>
<tr>
<td>es_node.fs.total_disk_reads</td>
<td>reads</td>
<td>从文件存储器读取的总次数</td>
</tr>
<tr>
<td>es_node.fs.total_disk_write_size_in_bytes</td>
<td>bytes</td>
<td>写入文件存储器的总字节数</td>
</tr>
<tr>
<td>es_node.fs.total_disk_writes</td>
<td>writes</td>
<td>写入文件存储器的总次数</td>
</tr>
<tr>
<td>es_node.fs.total_free_in_bytes</td>
<td>bytes</td>
<td>文件存储中未分配字节的总数</td>
</tr>
<tr>
<td>es_node.fs.total_total_in_bytes</td>
<td>bytes</td>
<td>文件存储的总大小</td>
</tr>
<tr>
<td>es_node.indices.get_current</td>
<td>requests</td>
<td>请求数</td>
</tr>
<tr>
<td>es_node.indices.get_exists_time</td>
<td>seconds</td>
<td>请求上的时间</td>
</tr>
<tr>
<td>es_node.indices.get_exists_total</td>
<td>requests</td>
<td>请求次数</td>
</tr>
<tr>
<td>es_node.indices.get_missing_time</td>
<td>seconds</td>
<td>请求上的时间</td>
</tr>
<tr>
<td>es_node.indices.get_missing_total</td>
<td>requests</td>
<td>请求次数</td>
</tr>
<tr>
<td>es_node.indices.get_time</td>
<td>seconds</td>
<td>请求上的总时间</td>
</tr>
<tr>
<td>es_node.indices.get_total</td>
<td>requests</td>
<td>请求次数</td>
</tr>
<tr>
<td>es_node.indices.flush_total</td>
<td>flushes</td>
<td>自启动以来</td>
</tr>
<tr>
<td>es_node.indices.flush_total_time</td>
<td>seconds</td>
<td>到磁盘所用的总时间</td>
</tr>
<tr>
<td>es_node.indices.query_cache_total_count</td>
<td>request</td>
<td>总的query_cache请求数</td>
</tr>
<tr>
<td>es_node.indices.query_cache_hit_count</td>
<td>request</td>
<td>query_cache命中的请求数</td>
</tr>
<tr>
<td>es_node.indices.query_cache_miss_count</td>
<td>request</td>
<td>query_cache未命中的请求数</td>
</tr>
<tr>
<td>es_node.indices.query_cache_memory_size_in_bytes</td>
<td>byte</td>
<td>query_cache占用内存大小</td>
</tr>
<tr>
<td>es_node.http.current_open</td>
<td>connection</td>
<td>连接数</td>
</tr>
<tr>
<td>es_node.http.total_opened</td>
<td>connection</td>
<td>的总连接数</td>
</tr>
<tr>
<td>es_node.indices.indexing_delete_current</td>
<td>document</td>
<td>中删除的文档数量</td>
</tr>
<tr>
<td>es_node.indices.indexing_delete_time</td>
<td>second</td>
<td>中删除文档花费的总时间</td>
</tr>
<tr>
<td>es_node.indices.indexing_delete_total</td>
<td>document</td>
<td>中删除的文档总数量</td>
</tr>
<tr>
<td>es_node.indices.indexing_index_current</td>
<td>document</td>
<td>中索引的文档数量</td>
</tr>
<tr>
<td>es_node.indices.indexing_index_time</td>
<td>second</td>
<td>索引文档所花费的时间</td>
</tr>
<tr>
<td>es_node.indices.indexing_index_total</td>
<td>document</td>
<td>中被索引的文档总数量</td>
</tr>
<tr>
<td>es_node.indices.segments_count</td>
<td>segments</td>
<td>分片中的段数</td>
</tr>
<tr>
<td>es_node.indices.segments_fixed_bit_set_memory_in_bytes</td>
<td>byte</td>
<td>内存中固定位设置使用的大小</td>
</tr>
<tr>
<td>es_node.indices.segments_index_writer_memory_in_bytes</td>
<td>byte</td>
<td>索引编写器使用的内存</td>
</tr>
<tr>
<td>es_node.indices.segments_memory_in_bytes</td>
<td>bytes</td>
<td>索引段使用的内存</td>
</tr>
<tr>
<td>es_node.indices.segments_version_map_memory_in_bytes</td>
<td>byte</td>
<td>段版本映射使用的内存</td>
</tr>
<tr>
<td>es_node.indices.merges_current</td>
<td>merge</td>
<td>当前的活跃段合并数量</td>
</tr>
<tr>
<td>es_node.indices.merges_current_docs</td>
<td>document</td>
<td>当前跨段合并的文档数量</td>
</tr>
<tr>
<td>es_node.indices.merges_current_size</td>
<td>byte</td>
<td>当前被合并的段的大小</td>
</tr>
<tr>
<td>es_node.indices.merges_total</td>
<td>merges</td>
<td>所有段的合并数量</td>
</tr>
<tr>
<td>es_node.indices.merges_total_docs</td>
<td>document</td>
<td>跨所有合并段的文档数量</td>
</tr>
<tr>
<td>es_node.indices.merges_total_size</td>
<td>byte</td>
<td>所有合并段的大小</td>
</tr>
<tr>
<td>es_node.indices.merges_total_time</td>
<td>second</td>
<td>花在合并段上的时间</td>
</tr>
<tr>
<td>es_node.indices.refresh_total</td>
<td>refreshe</td>
<td>索引刷新的总次数</td>
</tr>
<tr>
<td>es_node.indices.refresh_total_time</td>
<td>milli</td>
<td>索引刷新花费的总时间</td>
</tr>
<tr>
<td>es_node.indices.search_fetch_current</td>
<td>fetche</td>
<td>当前运行的搜索返回操作的数量</td>
</tr>
<tr>
<td>es_node.indices.search_fetch_open_contexts</td>
<td>querie</td>
<td>活跃的搜索数量</td>
</tr>
<tr>
<td>es_node.indices.search_fetch_time</td>
<td>second</td>
<td>在搜索返回操作上花费的总时间</td>
</tr>
<tr>
<td>es_node.indices.search_fetch_total</td>
<td>fetche</td>
<td>搜索返回操作总数量</td>
</tr>
<tr>
<td>es_node.indices.search_query_current</td>
<td>querie</td>
<td>当前运行的查询操作的数量</td>
</tr>
<tr>
<td>es_node.indices.search_query_time</td>
<td>second</td>
<td>在查询操作上花费的总时间</td>
</tr>
<tr>
<td>es_node.indices.search_query_total</td>
<td>querie</td>
<td>查询的操作的总数量</td>
</tr>
<tr>
<td>es_node.indices.store_size</td>
<td>bytes</td>
<td>存储的总大小</td>
</tr>
<tr>
<td>es_node.thread_pool.bulk_active</td>
<td>thread</td>
<td>线程池中的活跃线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.bulk_queue</td>
<td>thread</td>
<td>线程池中的排队线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.bulk_rejected</td>
<td>thread</td>
<td>线程池中被拒绝的线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.bulk_threads</td>
<td>thread</td>
<td>线程池中线程总数</td>
</tr>
<tr>
<td>es_node.thread_pool.flush_active</td>
<td>thread</td>
<td>线程池中的活跃线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.flush_queue</td>
<td>thread</td>
<td>线程池中的排队线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.flush_threads</td>
<td>thread</td>
<td>线程池中线程总数</td>
</tr>
<tr>
<td>es_node.thread_pool.generic_active</td>
<td>thread</td>
<td>线程池中的活跃线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.generic_queue</td>
<td>thread</td>
<td>线程池中的排队线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.generic_threads</td>
<td>thread</td>
<td>线程池中线程总数</td>
</tr>
<tr>
<td>es_node.thread_pool.get_active</td>
<td>thread</td>
<td>线程池中的活跃线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.get_queue</td>
<td>thread</td>
<td>线程池中的排队线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.get_threads</td>
<td>thread</td>
<td>线程池中线程总数</td>
</tr>
<tr>
<td>es_node.thread_pool.index_active</td>
<td>thread</td>
<td>线程池中的活跃线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.index_queue</td>
<td>thread</td>
<td>线程池中的排队线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.index_threads</td>
<td>threads</td>
<td>线程池中线程总数</td>
</tr>
<tr>
<td>es_node.thread_pool.management_active</td>
<td>thread</td>
<td>线程池中的活跃线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.management_queue</td>
<td>thread</td>
<td>线程池中的排队线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.management_threads</td>
<td>thread</td>
<td>线程池中线程总数</td>
</tr>
<tr>
<td>es_node.thread_pool.refresh_active</td>
<td>thread</td>
<td>线程池中的活跃线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.refresh_queue</td>
<td>thread</td>
<td>线程池中的排队线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.refresh_threads</td>
<td>thread</td>
<td>线程池中线程总数</td>
</tr>
<tr>
<td>es_node.thread_pool.search_active</td>
<td>thread</td>
<td>线程池中的活跃线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.search_queue</td>
<td>thread</td>
<td>线程池中的排队线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.search_threads</td>
<td>thread</td>
<td>线程池中线程总数</td>
</tr>
<tr>
<td>es_node.thread_pool.snapshot_active</td>
<td>thread</td>
<td>线程池中的活跃线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.snapshot_queue</td>
<td>thread</td>
<td>线程池中的排队线程数</td>
</tr>
<tr>
<td>es_node.thread_pool.snapshot_threads</td>
<td>thread</td>
<td>线程池中线程总数</td>
</tr>
<tr>
<td>es_node.jvm.gc_collectors_old_collection_time</td>
<td>second</td>
<td>GC）</td>
</tr>
<tr>
<td>es_node.jvm.gc_collectors_old_count</td>
<td>garbage</td>
<td>GC）</td>
</tr>
<tr>
<td>es_node.jvm.gc_collectors_young_collection_time</td>
<td>seconds</td>
<td>GC）</td>
</tr>
<tr>
<td>es_node.jvm.gc_collectors_young_count</td>
<td>garbage</td>
<td>GC）</td>
</tr>
<tr>
<td>es_node.jvm.mem_heap_committed</td>
<td>bytes</td>
<td>堆的内存量</td>
</tr>
<tr>
<td>es_node.jvm.mem_heap_used_percent</td>
<td>JVM</td>
<td>堆当前使用的内存量化百分比</td>
</tr>
<tr>
<td>es_node.jvm.mem_heap_max</td>
<td>bytes</td>
<td>堆可以使用的最大内存量</td>
</tr>
<tr>
<td>es_node.jvm.mem_heap_used</td>
<td>bytes</td>
<td>堆当前使用的内存量</td>
</tr>
<tr>
<td>es_node.jvm.mem_non_heap_committed</td>
<td>byte</td>
<td>非堆的内存量</td>
</tr>
<tr>
<td>es_node.jvm.mem_non_heap_used</td>
<td>byte</td>
<td>中非堆内存使用量</td>
</tr>
<tr>
<td>es_node.jvm.threads_count</td>
<td>thread</td>
<td>中活动线程的数量</td>
</tr>
<tr>
<td>es_node.jvm.threads_peak_count</td>
<td>thread</td>
<td>使用的线程的峰值数</td>
</tr>
</tbody>
</table>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Darcy</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2017/05/11/Elasticsearch监控/">http://www.darcy.org.cn/2017/05/11/Elasticsearch监控/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>The author owns the copyright, please indicate the source reproduced</li></ul></div><br><div class="tags"><a href="/tags/经验/">经验</a><a href="/tags/Elasticsearch/">Elasticsearch</a><a href="/tags/监控/">监控</a></div><div class="post-nav"><a class="pre" href="/2018/04/21/Redis高可用架构/">Redis高可用架构</a><a class="next" href="/2017/04/06/Elasticsearch部署优化/">Elasticsearch部署优化</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://www.darcy.org.cn"/></form></div><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://www.darcy.org.cn"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch/">Elasticsearch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/设计/" style="font-size: 15px;">设计</a> <a href="/tags/工具/" style="font-size: 15px;">工具</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Shell/" style="font-size: 15px;">Shell</a> <a href="/tags/Tool/" style="font-size: 15px;">Tool</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Thunderbird/" style="font-size: 15px;">Thunderbird</a> <a href="/tags/优化/" style="font-size: 15px;">优化</a> <a href="/tags/经验/" style="font-size: 15px;">经验</a> <a href="/tags/Elasticsearch/" style="font-size: 15px;">Elasticsearch</a> <a href="/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/tags/架构/" style="font-size: 15px;">架构</a> <a href="/tags/监控/" style="font-size: 15px;">监控</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/11/02/记一次Redis-Meet故障/">记一次Redis Meet故障</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/21/Redis高可用架构/">Redis高可用架构</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/11/Elasticsearch监控/">Elasticsearch监控</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/06/Elasticsearch部署优化/">Elasticsearch部署优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/11/Redis-主从复制/">Redis主从复制</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/11/Redis-持久化/">Redis持久化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/14/Redis中的used-memory与maxmemory解惑/">Redis中的used_memory与maxmemory解惑</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/20/thunderbird-jin-jie/">Thunderbird 进阶</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/19/linuxxia-ru-he-an-quan-shan-chu-wen-jian/">Linux下如何安全删除文件</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/06/23/mysqltong-ji-xin-xi/">MySQL统计信息</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://chaubeau.lofter.com" title="chaubeau" target="_blank">chaubeau</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Darcy Blog</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>